{"version":3,"sources":["./src/app/track/track.component.css","./src/app/track/track.component.html","./src/app/track/track.component.ts","./src/app/track/track.module.ts"],"names":[],"mappings":"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","file":"track.module.chunk.js","sourcesContent":["module.exports = \"#customerMonthly {\\n    height: 200px;\\n    width: 400px;\\n}\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/app/track/track.component.css\n// module id = ./src/app/track/track.component.css\n// module chunks = track.module","module.exports = \"<div class='main'>\\n  {{message}}\\n  <div [style.display]='customerDisplay'>\\n    <form #f=\\\"ngForm\\\" (ngSubmit)=\\\"onSubmit(f)\\\">\\n      From\\n      <input type=\\\"month\\\" (ngModelChange)='update()' [(ngModel)]='startDate' name='startMonth' useValueAsDate> To\\n      <input type=\\\"month\\\" (ngModelChange)='update()' [(ngModel)]='endDate' name='endMonth' useValueAsDate>\\n    </form>\\n    <h2>Total Spending</h2>\\n    <h3>$ {{spending}}</h3>\\n    <h2>Monthly Chart</h2>\\n    <div id='customerMonthly' style=\\\"display: block\\\">\\n      <canvas baseChart [datasets]=\\\"barChartData\\\" [labels]=\\\"barChartLabels\\\" [options]=\\\"barChartOptions\\\" [legend]=\\\"barChartLegend\\\"\\n        [chartType]=\\\"barChartType\\\">\\n      </canvas>\\n    </div>\\n  </div>\\n</div>\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/app/track/track.component.html\n// module id = ./src/app/track/track.component.html\n// module chunks = track.module","import { Component, OnInit } from '@angular/core';\nimport { CookieService } from 'ngx-cookie-service';\nimport { HttpClient } from '@angular/common/http';\nimport { NgForm } from '@angular/forms';\n\n@Component({\n  selector: 'app-track',\n  templateUrl: './track.component.html',\n  styleUrls: ['./track.component.css']\n})\nexport class TrackComponent implements OnInit {\n\n  tickets = [];\n  type = '';\n  customerDisplay = 'hidden';\n  agentDisplay = '';\n  message = '';\n  spending = 0;\n  startMonth = '';\n  endMonth = '';\n  startDate;\n  endDate;\n\n  barChartOptions = { scaleShowVerticalLines: false, responsive: true };\n  barChartLabels = [];\n  barChartType = 'bar';\n  barChartLegend = false;\n  barChartData = [{ data: [] }];\n\n  update() {\n    setTimeout(() => {\n      if (this.endDate.getTime() > new Date().getTime()) {\n        this.endDate = new Date();\n        this.endDate.setDate(2);\n      }\n      if (this.startDate.getTime() > this.endDate.getTime()) {\n        this.startDate = new Date(this.endDate);\n      }\n      this.startMonth = this.date2Month(this.startDate);\n      this.endMonth = this.date2Month(this.endDate);\n      this.updateChart(this.startMonth, this.endMonth);\n      this.spending = this.getSpending(this.filterMonth(this.startMonth, this.endMonth));\n    }, 10);\n  }\n\n  date2Month(d) {\n    const date = new Date(d);\n    return date.getFullYear() + '-' +\n      ('00' + (date.getMonth() + 1)).slice(-2);\n  }\n\n  filterMonth(start, end) {\n    const startDate = new Date(start);\n    const endDate = new Date(end);\n    const result = [];\n    endDate.setMonth(endDate.getMonth() + 1);\n    for (const each of this.tickets) {\n      const date = new Date(each.purchase_date);\n      if (date.getTime() <= endDate.getTime() && date.getTime() > startDate.getTime()) {\n        result.push(each);\n      }\n    }\n    return result;\n  }\n\n  updateChart(startMonth, endMonth) {\n    const start = new Date(startMonth);\n    const end = new Date(endMonth);\n    start.setDate(2);\n    end.setDate(2);\n    this.barChartLabels = [];\n    this.barChartData[0].data = [];\n    while (end.getTime() >= start.getTime()) {\n      this.barChartLabels.push(this.date2Month(start.getTime()));\n      this.barChartData[0].data.push(this.getSpending(this.filterMonth(start.getTime(), start.getTime())));\n      start.setMonth(start.getMonth() + 1);\n    }\n  }\n\n  getSpending(tickets) {\n    let result = 0;\n    for (const each of tickets) {\n      result += each.price;\n    }\n    return result;\n  }\n\n  getCommision(tickets) {\n    return this.getSpending(tickets) * 0.1;\n  }\n\n  getAverageCommision(tickets) {\n    return this.getCommision(tickets) / tickets.length;\n  }\n\n  onSubmit(f: NgForm) {\n\n  }\n\n  constructor(private cookie: CookieService, private http: HttpClient) { }\n\n  ngOnInit() {\n    this.type = this.cookie.get('type');\n    if (this.type === 'customer') {\n      this.customerDisplay = '';\n      this.http.get('/getFlights').subscribe(\n        res => {\n          for (const each of res['history']) {\n            this.tickets.push(each);\n          }\n          for (const each of res['upcoming']) {\n            this.tickets.push(each);\n          }\n          const start = new Date();\n          start.setDate(2);\n          start.setMonth(start.getMonth() - 5);\n          this.updateChart(start.getTime(), new Date().getTime());\n          const end = new Date();\n          end.setDate(2);\n          start.setMonth(start.getMonth() - 6);\n          this.spending = this.getSpending(this.filterMonth(start, end));\n          this.startMonth = this.date2Month(start);\n          this.endMonth = this.date2Month(end);\n          this.startDate = start;\n          this.endDate = end;\n        }\n      );\n    } else if (this.type === 'booking_agent') {\n      this.agentDisplay = '';\n      this.http.get('/getFlights').subscribe(\n        res => {\n          for (const each of res['history']) {\n            this.tickets.push(each);\n          }\n          for (const each of res['upcoming']) {\n            this.tickets.push(each);\n          }\n        }\n      );\n    } else {\n      this.message = 'Not authorized';\n    }\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/track/track.component.ts","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { RouterModule, Routes } from '@angular/router';\nimport { TrackComponent } from './track.component';\nimport { ChartsModule } from 'ng2-charts';\nimport { FormsModule } from '@angular/forms';\nimport { DateValueAccessorModule } from 'angular-date-value-accessor';\n\nconst route: Routes = [{ path: '', component: TrackComponent }];\n\n@NgModule({\n  imports: [CommonModule, RouterModule.forChild(route), ChartsModule, FormsModule, DateValueAccessorModule],\n  declarations: [TrackComponent]\n})\nexport class TrackModule { }\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/track/track.module.ts"],"sourceRoot":"webpack:///"}